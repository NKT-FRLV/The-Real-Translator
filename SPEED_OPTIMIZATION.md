# Оптимизация скорости перевода

## Настройки для максимальной скорости

### 1. Быстрые модели
Настроены самые быстрые модели в порядке приоритета:
- `openai/gpt-4o-mini` - самый быстрый GPT-4o
- `anthropic/claude-3.5-sonnet` - быстрый Claude
- `openai/gpt-4o` - альтернатива GPT-4o

### 2. Provider Routing
- Автоматический выбор самого быстрого провайдера
- Приоритет скорости над качеством
- Минимальные повторы (2)
- Быстрый таймаут (30 секунд)

### 3. Sub-Provider Routing (НОВОЕ!)
- Автоматический выбор самого быстрого sub-провайдера
- Приоритет: `openai` → `anthropic` → `google` → `meta`
- Минимальная задержка (latency: low)
- Максимальная пропускная способность (throughput: high)
- Быстрое переключение при сбоях (5 секунд)
- Fallback на альтернативные sub-провайдеры

### 4. Оптимизация стриминга
- Отключена буферизация nginx (`X-Accel-Buffering: no`)
- Chunked transfer encoding
- Keep-alive соединения
- Минимальные токены для быстрого ответа (800)

### 5. Параметры модели
- Temperature: 0 (детерминированный ответ)
- TopP: 0.9 (оптимизировано для скорости)
- Reasoning отключен для ускорения
- Максимальные токены: 800

### 6. Переменные окружения
```bash
TRANSLATION_MODEL=openai/gpt-4o-mini
OPENROUTER_PRIORITY=speed
OPENROUTER_TIMEOUT=30000
OPENROUTER_RETRIES=2
```

## Результат
- Максимальная скорость ответа
- Автоматический выбор быстрого провайдера
- Автоматический выбор быстрого sub-провайдера
- Оптимизированный стриминг
- Минимальная задержка
- Быстрое переключение при сбоях
